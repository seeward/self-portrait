<head>

  <title>Self Portrait</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js"></script>
  <script src="jquery.steps.min.js"></script>
  <link href="steps.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@magenta/image@0.2.1/dist/magentaimage.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bs-stepper/dist/js/bs-stepper.min.js"></script>
  <!-- Load three.js -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.106.2/build/three.min.js"></script>
  <!-- Load scatter-gl.js -->
  <script src="https://cdn.jsdelivr.net/npm/scatter-gl@0.0.1/lib/scatter-gl.min.js"></script>
  <style>
    body {
      background-color: black;
    }

    .canvas-wrapper,
    #scatter-gl-container {
      display: inline-block;
      vertical-align: top;

    }

    .canvas-wrapper {

      border-radius: 25px;
    }

    .canvas-wrapper canvas {
      border-radius: 25px;

    }

    #scatter-gl-container {
      position: relative;
      border-radius: 25px;

    }

    /* center the canvas within its wrapper */
    #scatter-gl-container canvas {
      transform: translate3d(-50%, -50%, 0);
      left: 50%;
      top: 50%;
      position: absolute;
      border-radius: 25px;
    }
  </style>

</head>

<body style="margin: 10px">
  <div id="main">

    <div id="example-basic">
      <h3>Self Portait</h3>
      <section>
        
      </section>
      <h3>Encode</h3>
      <section>
        <button class="btn btn-dark" id="init" type="button">Turn on video</button>
        <button class="btn btn-dark" id="addmesh" type="button">Toggle Mesh</button>
        <div class="canvas-wrapper">
          <canvas id="output"></canvas>
          <video id="video" playsinline style="
              -webkit-transform: scaleX(-1);
              transform: scaleX(-1);
              visibility: hidden;
              width: auto;
              height: auto;
              ">
          </video>
        </div>
        <div id="scatter-gl-container"></div>
        
      </section>
      <h3>Generate</h3>
      <section>
        <p>Wonderful transition effects.</p>
      </section>
      <h3>Explore</h3>
      <section>
        <p>The next and previous buttons help you to navigate through your content.</p>
      </section>
      <h3>Propagate</h3>
      <section>
        <p>The next and previous buttons help you to navigate through your content.</p>
      </section>
    </div>




    <div class="container" style="padding: 5px">
      <div class="row">
        <div class="col-md-5">
     
          
        </div>
        <div class="col-md-2">

          <div class="d-grid gap-2">
            <!-- <button class="btn btn-dark" id="init" type="button">Init</button> -->
            <button class="btn btn-dark" id="capture" type="button">Capture Portrait</button>
            <button class="btn btn-dark" id="transfer" type="button">Make 3D Model</button>
            <button class="btn btn-dark" id="ml" type="button">Generate Machine Portrait</button>
            <select class="form-select" id="styles" aria-label="Default select example">
              <option selected>Select Style</option>
              <option value="1">One</option>
              <option value="2">Two</option>
              <option value="3">Three</option>
              <option value="4">Four</option>
              <option value="5">Five</option>
              <option value="6">Six</option>
              <option value="7">Seven</option>
              <option value="8">Eight</option>
              <option value="9">Nine</option>
              <option value="10">Ten</option>
              <option value="11">Eleven</option>
            </select>
            <br />
            <input style="width:100%" type="file" onchange="handleLocalImage" class="form-control-file" id="localfile">
            <button class="btn btn-dark" id="localfileprocess" type="button">Extract Face Mesh</button>
          </div>
          <!-- <button type="button" id="capture" class="btn btn-light">Capture</button> -->
        </div>
        <div class="col-md-5">
          <iframe id="world" style="display:none;width: 500px;height: 500px;border-radius: 25px;"></iframe>
        </div>
      </div>

      <div class="row">
        <div class="col-md-4">
          <img id="result" style="display: none;" src="" width="250" height="250" />
        </div>
        <div class="col-md-4">
          <img id="resultmesh" style="display: none;" src="" width="250" height="250" />
        </div>
        <div class="col-md-4">
          <img id="resultpoints" style="display: none;" src="" width="250" height="250" />
        </div>


      </div>

      <div class="row">
        <div class="col-md-4">
          <canvas id="stylized1" src="" width="250" height="250" />
        </div>
        <div class="col-md-4">
          <canvas id="stylized2" src="" width="250" height="250" />
        </div>
        <div class="col-md-4">
          <canvas id="stylized3" src="" width="250" height="250" />
        </div>


      </div>


      <div>

        <img id="style1" style="display: none;" src="style1.png" width="250" height="250" />

        <img id="style2" style="display: none;" src="style2.jpg" width="250" height="250" />

        <img id="style3" style="display: none;" src="style3.jpg" width="250" height="250" />

        <img id="style4" style="display: none;" src="style4.jpg" width="250" height="250" />

        <img id="style5" style="display: none;" src="style5.jpg" width="250" height="250" />

        <img id="style6" style="display: none;" src="style6.jpg" width="250" height="250" />

        <img id="style7" style="display: none;" src="style7.jpg" width="250" height="250" />

        <img id="style8" style="display: none;" src="style8.jpg" width="250" height="250" />

        <img id="style9" style="display: none;" src="style9.jpg" width="250" height="250" />

        <img id="style10" style="display: none;" src="style10.jpg" width="250" height="250" />

        <img id="style11" style="display: none;" src="style11.jpg" width="250" height="250" />

        <canvas id="shadowmesh" style="display:none" src="" width="250" height="250" />
        <canvas id="shadowpoints" style="display:none" src="" width="250" height="250" />


      </div>




      <script>

        jQuery(document).ready(function () {
          // $("#wizard").steps();
          jQuery("#example-basic").steps({
            headerTag: "h3",
            bodyTag: "section",
            autoFocus: true
          });

          jQuery("#localfile").on('change', function () {
            handleLocalImage()
          });
        });

        function handleLocalImage() {
          console.log('into')
          const input = document.querySelector('#localfile')
          if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {

              document.querySelector('#result').style.display = 'inline'
              document.querySelector('#result').style.borderRadius = '25px'
              document.querySelector('#result').style.margin = '20px'
              document.querySelector('#result').src = e.target.result
            }
            reader.readAsDataURL(input.files[0]);
          }
        }
      </script>

    </div>
  </div>

  <canvas id="localoutput" style="display:none" src="" width="500" height="500" />


</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.6/dat.gui.min.js"></script>

<script src="index.js"></script>